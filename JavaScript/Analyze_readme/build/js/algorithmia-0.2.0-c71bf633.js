(function(){var e,t,n,r,i;window.Algorithmia=window.Algorithmia||{},Algorithmia.query&&console.error("Warning: algorithmia.js loaded twice"),Algorithmia.client&&console.error("Warning: algorithmia.js loaded twice"),Algorithmia.apiAddress&&console.log("Using alternate API server: "+Algorithmia.apiAddress),i=function(){return Algorithmia.apiAddress!==void 0?Algorithmia.apiAddress:"https://api.algorithmia.com/v1/web/algo"},r=/^(?:algo:\/\/|\/|)(\w+\/.+)$/,Algorithmia.query=function(e,t,n,r){return Algorithmia.client(t).algo(e).pipe(n,function(e){return e.error?r(e.error.message||e.error):r(void 0,e.result)})},Algorithmia.client=function(e,n){return e=e||Algorithmia.apiKey,n=n||i(),new t(e,n)},t=function(t,n){this.api_key=t,this.api_address=n,this.algo=function(t){return t&&typeof t=="string"?new e(this,t):(console.error("Invalid algorithm url: "+t),null)}},Algorithmia.algo=function(e){return Algorithmia.client().algo(e)},e=function(e,t){if(typeof t!="string"||!t.match(r))throw"Invalid Algorithm URI (expected /owner/algo)";this.client=e,this.algo_uri=t.match(r)[1],this.pipe=function(t,r){var i;return Algorithmia.startTask(),i=new n(function(n){return function(r){var i,s;return s=new XMLHttpRequest,s.onreadystatechange=function(){var e,t;if(s.readyState===4){Algorithmia.finishTask();if(s.status===0)s.responseText?r({error:"API connection error: "+s.responseText}):r({error:"API connection error"});else if(s.status===502)r({error:"API error, bad gateway"});else if(s.status===503)r({error:"API error, service unavailable"});else if(s.status===504)r({error:"API error, server timeout"});else try{t=JSON.parse(s.responseText),r(t)}catch(n){e=n,r({error:"API error (status "+s.status+"): "+e})}}},i=e.api_address+"/"+n.algo_uri,s.open("POST",i,!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Accept","application/json, text/javascript"),e.api_key&&s.setRequestHeader("Authorization","Simple "+e.api_key),s.send(JSON.stringify(t))}}(this)),r&&i.then(r),i}},n=function(e){var t;this.isComplete=!1,this.listeners=[],this.result=void 0,t=function(e){return function(t){var n,r,i,s;e.result=t,e.isComplete=!0,s=e.listeners;for(r=0,i=s.length;r<i;r++){n=s[r];try{n(t)}catch(o){}}}}(this),this.then=function(e){return function(t){if(!e.isComplete)return e.listeners.push(t);try{return t(e.result)}catch(n){}}}(this),e(t)},Algorithmia.tasksInProgress=0,Algorithmia.startTask=function(){var e,t,n,r;if(Algorithmia.tasksInProgress===0){r=document.getElementsByClassName("algo-spinner");for(t=0,n=r.length;t<n;t++)e=r[t],e.style.visibility="visible"}Algorithmia.tasksInProgress++},Algorithmia.finishTask=function(){var e,t,n,r;Algorithmia.tasksInProgress--;if(Algorithmia.tasksInProgress===0){r=document.getElementsByClassName("algo-spinner");for(t=0,n=r.length;t<n;t++)e=r[t],e.style.visibility="hidden"}else Algorithmia.tasksInProgress<0&&console.error("Algorithmia task error (unknown task finished)")},Algorithmia.onload&&typeof Algorithmia.onload=="function"&&Algorithmia.onload()}).call(this);